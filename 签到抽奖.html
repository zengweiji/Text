<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>脱贫宝-签到</title>
<script src="js/jquery-1.10.2.min.js"></script>
<script src="js/Header.js"></script>
<script src="js/public.js"></script>
<link href="css/base.css" rel="stylesheet" type="text/css">
<link href="css/myaccount.css" rel="stylesheet" type="text/css">
</head>
<style>
body, html { background-color:#fff4e0; height:100%; }
</style>
<body>
<header class="ld-header noBg">
    <a href="javascript:history.go(-1);" class="left-ctl goback"></a>
    <a href="#" class="qd-hd-barbtn1 btn-ctl">奖励记录</a>
    <a href="签到规则.html" class="qd-hd-barbtn2 btn-ctl">活动规则</a>
</header>
<div class="qd-main">
     <div class="qd-part01">
          <div class="qd-hd"> 
               <!--     几种状态的按钮
				<a href="#" class="qd-m-btn">立即登录</a>
            	<a href="#" class="qd-m-btn">今日签到</a>
             	<a href="#" class="qd-m-btn">签到中...</a>
 -->      
               <a href="#" class="qd-g-btn js-ist"><span class="qd-btn-tips-a">分享签到</span><span class="qd-btn-tips-b">已连签<i class="red">2</i>天</span></a> </div>
     </div>
     <div class="qd-part02">
          <div class="qd-luckbox">
               <h3  class="qd-luckbox-hd"><a class="qd-cj-record" href="抽奖记录.html">您还有<i class="gold">0</i>次抽奖机会&nbsp;&nbsp;</a></h3>
               <div id="lottery">
                    <ul class="prizebox">
                         <li class="lottery-unit lottery-unit-0"><img src="images/h5-ticket00.png" alt="200元"></li>
                         <li class="lottery-unit lottery-unit-1"><img src="images/h5-ticket01.png" alt="1000元"></li>
                         <li class="lottery-unit lottery-unit-2"><img src="images/h5-ticket02.png" alt="500元"></li>
                         <li class="lottery-unit lottery-unit-3"><img src="images/h5-ticket03.png" alt="100元"></li>
                         <li class="lottery-unit lottery-unit-6"><img src="images/h5-ticket06.png" alt="30元"></li>
                         <li class="lottery-unit lottery-unit-5"><img src="images/h5-ticket05.png" alt="10000元"></li>
                         <li class="lottery-unit lottery-unit-4"><img src="images/h5-ticket04.png" alt="0.05元"></li>
                         <li class="lottery-unit lottery-unit-7"><img src="images/h5-ticket07.png" alt="0.5元"></li>
                         <li class="lottery-unit lottery-unit-8"><img src="images/h5-ticket08.png" alt="100元"></li>
                         <li class="lottery-unit lottery-unit-9"><img src="images/h5-ticket09.png" alt="50元"></li>
                         <li class="lottery-unit lottery-unit-10"><img src="images/h5-ticket10.png" alt="1元"></li>
                    </ul>
                    <div class="clear"></div>
                    <a href="javascript:;" class="luckbtn js-luckbtn"><!--立即抽奖--></a> </div>
          </div>
     </div>
     <div class="qd-part03">
          <div class="winner-list">
               <ul class="lbBox">
                    <li><span class="lineBlock lefttxt">130****3347</span><span class="lineBlock righttxt">220元</span></li>
                    <li><span class="lineBlock lefttxt">150****5537</span><span class="lineBlock righttxt">10660元</span></li>
                    <li><span class="lineBlock lefttxt">187****3627</span><span class="lineBlock righttxt">1400元</span></li>
                    <li><span class="lineBlock lefttxt">150****8526</span><span class="lineBlock righttxt">222300元</span></li>
                    <li><span class="lineBlock lefttxt">120****3547</span><span class="lineBlock righttxt">44000元</span></li>
                    <li><span class="lineBlock lefttxt">147****3627</span><span class="lineBlock righttxt">1400元</span></li>
                    <li><span class="lineBlock lefttxt">122****8526</span><span class="lineBlock righttxt">200元</span></li>
                    <li><span class="lineBlock lefttxt">144****3547</span><span class="lineBlock righttxt">11000元</span></li>
               </ul>
          </div>
     </div>
</div>
<!-- 签到获得现金弹出框 -->
<div class="Jdialog" id="Jdialog-qd1">
     <div class="lineBlock Jdialog_box qd-tips">
          <div class="qd-tips-box">
               <div class="qd-tips-ico"></div>
               <span class="qd-tips-cls js-tips-cls"></span>
               <dl class="qd-tips-cont">
                    <dt><i class="lineBlock"></i>您已连续签到2天!</dt>
                    <dd><i class="lineBlock"></i>本次获得<span class="gold">0.06</span>元现金</dd>
                    <dd class="qd-chatu"></dd>
               </dl>
               <a href="#" class="qd-tips-btn js-share-btn">分享即获双倍奖励</a> </div>
     </div>
     <b class="lineBlock"></b> </div>

<!-- 签到获得现金弹出框end --> 

<!-- 签到获得现金+抽奖机会弹出框 -->
<div class="Jdialog" id="Jdialog-qd2">
     <div class="lineBlock Jdialog_box qd-tips">
          <div class="qd-tips-box">
               <div class="qd-tips-ico"></div>
               <span class="qd-tips-cls js-tips-cls"></span>
               <dl class="qd-tips-cont">
                    <dt>您已连续签到2天!</dt>
                    <dd>本次获得<span class="gold">0.06</span>元现金和<span class="gold">1</span>次抽奖机会</dd>
                    <dd><span class="qd-tips-cj">还有<i class="cj-num">1</i>次抽奖机会</span></dd>
               </dl>
               <a href="#" class="qd-tips-btn stylew">立即抽奖</a> <a href="#" class="qd-tips-btn js-share-btn">分享即获双倍奖励</a> </div>
     </div>
     <b class="lineBlock"></b> </div>

<!-- 抽奖机会弹出框end --> 

<!--中奖弹出框 -->
<div class="Jdialog" id="Jdialog-qd3">
     <div class="lineBlock Jdialog_box qd-tips qd-lottery">
          <div class="qd-tips-ico"> <strong class="qd-lottery-prize"><i class="qd-ltnum">10000</i>元</strong>
               <p class="qd-lottery-text"><span class="gold">人品大爆发，再接再厉！</span></p>
          </div>
          <div class="qd-tips-box"> <span class="qd-tips-cls js-tips-cls"></span>
               <div class="qd-tips-cont">
                    <h1 class="qd-tips-times">您的抽奖机会已经用完<br>
                         查看抽奖规则了解更多抽奖机会</h1>
                    <a href="#" class="qd-tips-btn stylew">查看抽奖规则</a> <a href="#" class="qd-tips-btn js-share-btn">分享即获双倍奖励</a> </div>
          </div>
     </div>
     <b class="lineBlock"></b> </div>

<!-- 中奖弹出框end --> 

<!--分享-->
<div class="share-list-wrap">
     <div class="share-list-overlay"></div>
     <div class="share-list">
          <div class="bdsharebuttonbox lbBox"><a class="bds_wxpy lineBlock" href="#"></a> <a class="bds_qzone lineBlock" href="#"></a> </div>
          <div class="simple-btns"> <a class="simple-btn cancel" href="javascript:void(0)">取消</a> </div>
     </div>
</div>
<script type="text/javascript">

      
$(function(){
		var jd = $("#Jdialog-qd3");
		 jd.Jdialog({state: 'close'});//关闭	 
		$(".js-tips-cls").click(function(){
			 jd.Jdialog({state: 'close'});//关闭	 
		});
    	
		$('.js-share-btn').click(function(){//分享
			$('.share-list-wrap').show();			
		});
		$('.share-list-overlay,.share-list .cancel').click(function(){			
			$('.share-list-wrap').hide()						
		});
   
		//获奖名单滚动
		var $this = $(".winner-list");
		var scrollTimer;
		$this.hover(function() {
			clearInterval(scrollTimer);
		},
		function() {
			scrollTimer = setInterval(function() {
				scrollNews($this);
			},
			2000);
		}).trigger("mouseout");
	
})

//li获奖名单滚动
function scrollNews(obj) {
    var $self = obj.find("ul:first");
    var lineHeight = $self.find("li:first").outerHeight();
    $self.animate({		
        "margin-top": -lineHeight + "px"
    },
    600,
    function() {
        $self.css({
            "margin-top": "0px"
        }).find("li:first").appendTo($self);
    })
}

//抽奖格子start
var lottery={
	index:-1,	//当前转动到哪个位置，起点位置
	count:0,	//总共有多少个位置
	timer:0,	//setTimeout的ID，用clearTimeout清除
	speed:20,	//初始转动速度,值越大越慢
	times:0,	//转动次数
	cycle:50,	//转动基本次数：即至少需要转动多少次再进入抽奖环节
	prize:-1,	//初始中奖位置
	attr: [200, 1000, 500, 100, 0.05, 10000, 300, 0.5, 10, 50, 1],
	init:function(id){
		if ($("#"+id).find(".lottery-unit").length>0) {
			$lottery = $("#"+id);
			$units = $lottery.find(".lottery-unit");
			this.obj = $lottery;
			this.count = $units.length;
			$lottery.find(".lottery-unit-"+this.index).addClass("active");
		};
	},
	roll:function(){
		var index = this.index;
		var count = this.count;
		var lottery = this.obj;
		$(lottery).find(".lottery-unit-"+index).removeClass("active");
		index += 1;
		if (index>count-1) {
			index = 0;
		};
		$(lottery).find(".lottery-unit-"+index).addClass("active");
		this.index=index;
		return false;
	},
	stop:function(index){
		this.prize=index;
		return false;
	}
};

function roll(){
	lottery.times += 1;
	lottery.roll();
	if (lottery.times > lottery.cycle+10 && lottery.prize==lottery.index) {
		clearTimeout(lottery.timer);
		lottery.prize=-1;
		lottery.times=0;
		click=false;
		rollSuccess(lottery.index);
	}else{
		if (lottery.times<lottery.cycle) {
			lottery.speed -= 10;
		}else if(lottery.times==lottery.cycle) {
			var index = Math.random()*(lottery.count)|0;
			lottery.prize = index;
		}else{
			if (lottery.times > lottery.cycle+10 && ((lottery.prize==0 && lottery.index==7) || lottery.prize==lottery.index+1)) {
				lottery.speed += 110;
			}else{
				lottery.speed += 20;
			}
		}
		if (lottery.speed<40) {
			lottery.speed=40;
				
		};
	
		lottery.timer = setTimeout(roll,lottery.speed);
	}
	return false;
}
//中奖回调方法
function rollSuccess(index) {
	 setTimeout(function() {
       $("#Jdialog-qd3").Jdialog();
	   $("#Jdialog-qd3").find(".qd-ltnum").html(lottery.attr[index]);
    }, 800); 
}

var click=false;

window.onload=function(){
	lottery.init('lottery');
	$(".js-luckbtn").click(function(){
		if (click) {
			return false;
		}else{
		    lottery.speed=100;
			roll();
			click=true;
			return false;
		}
	});
};
//抽奖格子end
</script>
</body>
</html>
